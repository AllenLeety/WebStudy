管道（匿名）
1 管道的概念
  （1）本质
   固定大小的 内核缓冲区；伪文件--不占用磁盘空间，内核的一块缓冲区
  （2）特点
    两部分：
      读端，写端，对应两个文件描述符
      数据写端流入，读端流出
    操作管道的进程被销毁之后，管道自动被释放了
    管道默认是阻塞的
      读写都是阻塞的
2 管道的原理
  （1）内部实现方式：队列
    环形队列
    特点：先进先出
  （2）缓冲区大小
    默认4k
    大小会根据世纪情况做适当调整
3 管道的局限性
  （1）队列：
    数据只能读取一次，不能重复读取
  （2）半双工通信方式：
      单工：遥控器
      半双工：对讲机
          数据传输的方向是单向的
      双工：电话
  （3）匿名管道
      适用于有血缘关系的进程
4 创建匿名管道
  int pipe(int fd[2]);
    包含头文件 <unistd.h>
    参数 fd：文件描述符数组，其中fd[0]表示读端，fd[1]表示写端
    返回值：成功返回0，失败返回-1
5 管道的读写行为
  （1）读操作
    a.有数据
      read(fd)    正常读，返回读出的字节数
    b.无数据
      写端全部关闭
        read解除阻塞，返回0
        相当于读文件读到了尾部
      没有全部关闭
        read阻塞
  （2）写操作
    a.读端全部关闭
      管道破裂，进程被终止
          内核给当前进程发信号SIGPIPE，该信号会终止进程
    b.读端没全部关闭
      缓冲区写满了
          write阻塞
      缓冲区没有满
          write继续写
  （3）如何设置非阻塞？
      管道莫认识读写两端都阻塞
      设置读端为非阻塞pipe(fd)
        fcntl -- 变参函数
          复制文件文件描述符--dup
          修改文件属性--open的时候对应flag属性
        设置方法：
          获取原来的flags
          int flags = fcntl(fd[0], F_GETFL);//F_GETFL为获取flag属性
          //设置新的flags
          flags |= O_NOBLOCK;//等价于flags = flags | O_NONBLOCK;
          fcntl(fd[0], F_SETFL, flags);
6 fifo管道（命名管道）
  管道应用的一个限制就是只能在具有共同祖先（具有血缘关系）的进程见通信。
  如果我们想在不相关的进程之间交换数据，可以使用FIFO文件来做这项工作，他经常被称为命名管道。
  命名管道是一种特殊类型的文件。
（1）特点
    有名管道
    在磁盘上有这样一个文件 ls -|  -> p  即ls -| 可以查到pipe
    是伪文件，在磁盘大小永远为0
    在内核中有一个对应的缓冲区
    半双工的通信方式
（2）使用场景
    没有血缘关系的进程间通信
（3）创建方式
    a.从命令行上创建
        输入 mkfifo filename
    b.从程序李创建
        int mkfifo(const char *pathname, mode_t mode);
        可以man 3 mkfifo查询
7 匿名管道与命名管道比较
    匿名管道由pipe函数创建并打开
    命名管道由mkfifo函数创建，打开用open
    FIFO（命名管道）与pipe（匿名管道）之间唯一的区别在他们创建与打开的方式不同，一旦这些工作完成之后，他们具有相同的语义

